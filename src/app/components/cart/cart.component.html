<!-- ============================================================ -->
<!-- CART PAGE TEMPLATE                                           -->
<!-- Shows cart items with quantity controls and order summary.    -->
<!-- Demonstrates reading Angular Signals in templates.           -->
<!-- ============================================================ -->

<!-- Empty cart state -->
@if (cartService.items().length === 0) {
  <div class="empty-cart">
    <div class="empty-cart-icon">ðŸ›’</div>
    <h2>Your cart is empty</h2>
    <p>Looks like you haven't added any products yet.</p>
    <a routerLink="/products" class="btn-primary">Browse Products</a>
  </div>
} @else {
  <!-- Cart with items -->
  <div class="cart-page">

    <!-- â”€â”€ Cart Items List â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div class="cart-items">
      <h1>Shopping Cart ({{ cartService.itemCount() }} items)</h1>

      @for (item of cartService.items(); track item.product.id) {
        <div class="cart-item">
          <!-- Product image -->
          <a [routerLink]="['/product', item.product.id]" class="item-image-link">
            <img [src]="item.product.image" [alt]="item.product.name" class="item-image" />
          </a>

          <!-- Product info -->
          <div class="item-info">
            <h3>
              <a [routerLink]="['/product', item.product.id]">{{ item.product.name }}</a>
            </h3>
            <p class="item-category">{{ item.product.category }}</p>
            <p class="item-price">{{ item.product.price | currency:'USD' }} each</p>
          </div>

          <!-- Quantity controls -->
          <div class="quantity-controls">
            <button (click)="updateQuantity(item.product.id, item.quantity - 1)"
                    class="qty-btn">
              âˆ’
            </button>
            <span class="qty-value">{{ item.quantity }}</span>
            <button (click)="updateQuantity(item.product.id, item.quantity + 1)"
                    [disabled]="item.quantity >= item.product.stock"
                    class="qty-btn">
              +
            </button>
          </div>

          <!-- Item subtotal -->
          <p class="item-subtotal">
            {{ item.product.price * item.quantity | currency:'USD' }}
          </p>

          <!-- Remove button -->
          <button (click)="removeItem(item.product.id)" class="btn-remove">
            âœ•
          </button>
        </div>
      }
    </div>

    <!-- â”€â”€ Order Summary Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <aside class="order-summary">
      <h2>Order Summary</h2>

      <div class="summary-row">
        <span>Subtotal ({{ cartService.itemCount() }} items)</span>
        <span>{{ cartService.totalPrice() | currency:'USD' }}</span>
      </div>

      <div class="summary-row">
        <span>Shipping</span>
        <span class="free-shipping">Free</span>
      </div>

      <div class="summary-divider"></div>

      <div class="summary-row total">
        <span>Total</span>
        <span>{{ cartService.totalPrice() | currency:'USD' }}</span>
      </div>

      <button (click)="proceedToCheckout()" class="btn-checkout">
        Proceed to Checkout
      </button>

      <a routerLink="/products" class="continue-shopping">
        &larr; Continue Shopping
      </a>
    </aside>
  </div>
}
